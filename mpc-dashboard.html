<!DOCTYPE html>
<html>
<head>
    <title>MPC Comparison</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial; margin: 20px; }
        .mpc-card { padding: 15px; margin: 10px; border-radius: 8px; color: white; }
        .he-nmpc { background: #FF6B6B; }
        .stochastic { background: #4ECDC4; }
        .hempc { background: #45B7D1; }
        .mixedinteger { background: #96CEB4; }
        .standard { background: #FFEAA7; color: black; }
        .ranking { font-size: 18px; margin: 10px; padding: 10px; background: #f0f0f0; }
        button { background: #007bff; color: white; padding: 10px; border: none; border-radius: 5px; margin: 5px; }
    </style>
</head>
<body>
    <h1>üìä MPC Algorithm Comparison</h1>
    <button onclick="goHome()">‚Üê Back to Main</button>
    <button onclick="runComparison()">Run New Comparison</button>
    
    <div id="ranking"></div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div>
            <canvas id="efficiencyChart" width="400" height="300"></canvas>
        </div>
        <div>
            <canvas id="costChart" width="400" height="300"></canvas>
        </div>
    </div>

    <div id="mpcResults"></div>

    <script>
        let efficiencyChart, costChart;

        function initCharts() {
            efficiencyChart = new Chart('efficiencyChart', {
                type: 'bar',
                data: {
                    labels: ['HE-NMPC', 'Stochastic', 'HEMPC', 'Mixed-Integer', 'Standard'],
                    datasets: [{
                        label: 'Efficiency (%)',
                        data: [76.3, 75.1, 74.8, 74.2, 73.5],
                        backgroundColor: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7']
                    }]
                }
            });

            costChart = new Chart('costChart', {
                type: 'bar',
                data: {
                    labels: ['HE-NMPC', 'Stochastic', 'HEMPC', 'Mixed-Integer', 'Standard'],
                    datasets: [{
                        label: 'Cost (KES/m¬≥)',
                        data: [3.65, 3.82, 3.91, 4.05, 4.20],
                        backgroundColor: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7']
                    }]
                }
            });
        }

        async function runComparison() {
            const response = await fetch('/api/mpc/compare');
            const data = await response.json();
            
            // Update ranking
            document.getElementById('ranking').innerHTML = 
                '<h2>üèÜ Performance Ranking</h2>' +
                data.comparison.ranking.map((rank, i) => `
                    <div class="ranking">
                        ${i+1}. ${rank.mpcType} (Score: ${rank.score})
                    </div>
                `).join('');
            
            // Update MPC cards
            document.getElementById('mpcResults').innerHTML = 
                Object.entries(data.comparison.individual_results).map(([type, result]) => `
                    <div class="mpc-card ${type.toLowerCase().replace('-mpc', '').replace('mixedinteger', 'mixedinteger')}">
                        <h3>${type}</h3>
                        <p>Current: ${result.optimal_current}A</p>
                        <p>Efficiency: ${result.efficiency}%</p>
                        <p>Cost: ${result.cost} KES/m¬≥</p>
                    </div>
                `).join('');
        }

        function goHome() {
            window.location.href = '/';
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            runComparison();
        });
    </script>
</body>
</html>
